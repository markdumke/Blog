---
title: 'Intermingle R and Python in R Markdown'
author: Markus Dumke
date: '2017-11-09'
description: >
  Intermingle R and Python in R Markdown
---



<p>This blog post shows how to use R and Python inside one document and how to easily intermingle code, plain text and graphics and share data between R and Python.</p>
<div id="why-r-markdown" class="section level2">
<h2>Why R Markdown?</h2>
<p>R Markdown is great to make reproducible reports or presentations and allows to intermingle code, plain text and figures. It comes with a wide variety of output formats, e.g.Â pdf, html, word or latex beamer slides. You can even embed shiny apps in a html report. For example this document was generated with R Markdown.</p>
<p>In the following we will show how to combine R and Python code chunks inside one R Markdown document and how to share data between these chunks. Therefore R Markdown is a great tool for data scientists who wants to make the most out of the tools R and Python offer for data science.</p>
</div>
<div id="r-code-chunks" class="section level2">
<h2>R code chunks</h2>
<p>Using R code in R Markdown is easy:</p>
<pre class="r"><code>library(ggplot2)
head(iris)
ggplot(iris, aes(Sepal.Length, Sepal.Width, col = Species)) +
  geom_point(size = 3) + theme_bw()</code></pre>
</div>
<div id="python-code-chunks" class="section level2">
<h2>Python code chunks</h2>
<p>We can also include Python code chunks. We will use <code>knitr::knit_engines$set(python = reticulate::eng_python)</code> in the setup to render the Python code. Make sure to install the newest <code>reticulate</code> package via <code>devtools::install_github(&quot;rstudio/reticulate&quot;)</code>.</p>
<pre class="python"><code>import numpy as np
x = np.arange(10)
y = x**2</code></pre>
<p>And the objects are still available in the next Python chunk.</p>
<pre class="python"><code>print(y)</code></pre>
<p>We can also include plots.</p>
<pre class="python"><code>import matplotlib.pyplot as plt
plt.plot(x, y)
plt.show()</code></pre>
</div>
<div id="share-data-between-r-and-python-chunks" class="section level2">
<h2>Share data between R and Python chunks</h2>
<p>To share objects between Python and R chunks we need to save the files at the end of a chunk and load again in the next chunk. The best way to do this is probably <a href="https://blog.rstudio.com/2016/03/29/feather/">feather</a>.</p>
<p>Get the iris data set into Python using feather. First save it in an R chunk.</p>
<pre class="r"><code>library(feather)
write_feather(iris, &quot;iris.feather&quot;)</code></pre>
<p>Then we can load the file in a Python chunk.</p>
<pre class="python"><code>import feather
iris = feather.read_dataframe(&quot;iris.feather&quot;)
print(iris.head())</code></pre>
<p>To share data frames from a Python chunk to an R chunk you can run</p>
<pre class="python"><code>import pandas as pd
d = {&#39;col1&#39;: [1, 2, 6, 8], &#39;col2&#39;: [&quot;first&quot;, &quot;lab&quot;, &quot;d&quot;, &quot;car&quot;]}
df = pd.DataFrame(data = d)
feather.write_dataframe(df, &quot;df.feather&quot;)
print(df.head())</code></pre>
<p>and load it in an R chunk with</p>
<pre class="r"><code>df &lt;- read_feather(&quot;df.feather&quot;)
df</code></pre>
</div>
